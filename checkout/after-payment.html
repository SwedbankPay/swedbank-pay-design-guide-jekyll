<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="theme-color" content="#000">
        <meta name="application-name" content="Checkout – After Payment">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="apple-mobile-web-app-title" content="Checkout – After Payment">
        <meta name="msapplication-TileColor" content="#000">
        <meta name="msapplication-TileImage" content="/icons/mstile-144x144.png">
        <meta property="og:type" value="website" />
        <meta property="og:url" value="https://swedbankpay.github.io/swedbank-pay-design-guide-jekyll-theme/checkout/after-payment.html" />
        <meta property="og:title" value="Checkout – After Payment" />
        <meta name="title" content="Checkout – After Payment" />
        <meta property="og:description" value="Swedbank Pay Design Guide theme for Jekyll" />
        <meta name="description" content="Swedbank Pay Design Guide theme for Jekyll" />
        <meta property="og:image" value="/image1.png" />
        <title>Checkout – After Payment</title>
        <link rel="stylesheet" href="https://design.swedbankpay.com/v/5.0.1/styles/dg-style.css" />
        <link rel="stylesheet" href="/swedbank-pay-design-guide-jekyll-theme/assets/css/style.css">
        <link rel="stylesheet" href="/swedbank-pay-design-guide-jekyll-theme/assets/css/pygments-autumn.css">
        <link rel="shortcut icon" href="https://design.swedbankpay.com/v/5.0.1/icons/favicon.ico">
        <link rel="icon" type="image/png" sizes="16x16" href="https://design.swedbankpay.com/v/5.0.1/icons/favicon-16x16.png">
        <link rel="icon" type="image/png" sizes="32x32" href="https://design.swedbankpay.com/v/5.0.1/icons/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="228x228" href="https://design.swedbankpay.com/v/5.0.1/icons/coast-228x228.png">
        <link href="https://fonts.googleapis.com/css?family=Material+Icons+Outlined" rel="stylesheet">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="After Payment">
<link rel="apple-touch-icon" sizes="57x57" href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="167x167" href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-icon-167x167.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-icon-180x180.png">
<link rel="apple-touch-icon" sizes="1024x1024" href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-icon-1024x1024.png">
<link rel="apple-touch-startup-image"
    media="(device-width: 320px) and (device-height: 480px) and  (-webkit-device-pixel-ratio: 1)"
    href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-startup-image-320x460.png">
<link rel="apple-touch-startup-image"
    media="(device-width: 320px) and (device-height: 480px) and  (-webkit-device-pixel-ratio: 2)"
    href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-startup-image-640x920.png">
<link rel="apple-touch-startup-image"
    media="(device-width: 320px) and (device-height: 568px) and  (-webkit-device-pixel-ratio: 2)"
    href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-startup-image-640x1096.png">
<link rel="apple-touch-startup-image"
    media="(device-width: 375px) and (device-height: 667px) and  (-webkit-device-pixel-ratio: 2)"
    href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-startup-image-750x1294.png">
<link rel="apple-touch-startup-image"
    media="(device-width: 414px) and (device-height: 736px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 3)"
    href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-startup-image-1182x2208.png">
<link rel="apple-touch-startup-image"
    media="(device-width: 414px) and (device-height: 736px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 3)"
    href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-startup-image-1242x2148.png">
<link rel="apple-touch-startup-image"
    media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 1)"
    href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-startup-image-748x1024.png">
<link rel="apple-touch-startup-image"
    media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 1)"
    href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-startup-image-768x1004.png">
<link rel="apple-touch-startup-image"
    media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)"
    href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-startup-image-1496x2048.png">
<link rel="apple-touch-startup-image"
    media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)"
    href="https://design.swedbankpay.com/v/5.0.1/icons/apple-touch-startup-image-1536x2008.png">
<script src="/swedbank-pay-design-guide-jekyll-theme/assets/js/mermaid.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="/swedbank-pay-design-guide-jekyll-theme/assets/tipuesearch/tipuesearch_content.js"></script>
        <script src="/swedbank-pay-design-guide-jekyll-theme/assets/tipuesearch/tipuesearch_set.js"></script>
        <script src="/swedbank-pay-design-guide-jekyll-theme/assets/tipuesearch/tipuesearch.min.js"></script>
    </head>

    <body>
        <div id="designguide">
            <div class="documentation">
                <div class="d-md-flex">
                    <div class="d-none d-lg-block">
                        <div id="dg-sidebar2" class="sidebar-2 has-secondary-nav" >
                            <nav class="sidebar-main-nav">
                                <div class="sidebar-logo">
                                    <a href="/"><img src="https://design.swedbankpay.com/v/5.0.1/img/swedbankpay-logo-v.svg" alt="Swedbank Pay vertical logo" class="logotype-vertical logotype-md">
                                    </a></div>
                                
                                <!-- <form class="search-container mx-2 my-4 px-3 py-2 d-flex"
                                    method="get" action="/swedbank-pay-design-guide-jekyll-theme/search">
                                    <input name="q" type="text" id="tipue_search_input"
                                        class="search-input w-100 "
                                        placeholder="Search in documentation"
                                        onfocus="this.placeholder=''"
                                        onblur="this.placeholder='Search in documentation'"
                                        pattern=".{3,}"
                                        title="At least 3 characters">
                                    <button class="mb-0">
                                        <i class="material-icons m-0" aria-hidden="true">search</i>
                                    </button>
                                </form> -->
                                
                                <ul class="main-nav-ul" id="dx-sidebar-main-nav-ul">
                                </ul>
                            </nav>
                        </div>
                    </div>

                    <main class="doc-view">
                        
                            





<div class="title-header">
    <div class="title-header-container max-width">
        
            <h4>Checkout</h4>
        

        <h1>After Payment</h1>

        

        
            <p><p>Add After-payment operation to your order system</p>
</p>
        
    </div>

    

<a href="https://github.com/SwedbankPay/swedbank-pay-design-guide-jekyll-theme/tree/master/checkout/after-payment.md"
    class="github" target="_blank"
    rel="noopener noreferrer" title="Edit 'After Payment' on GitHub">
    <svg aria-labelledby="simpleicons-github-icon" role="img" width="40" viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg">
        <title id="simpleicons-github-icon">Edit "After Payment" on GitHub</title>
        <path fill="#fff" d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" />
    </svg>
</a>

</div>

                        
                        <div class="doc-container normal-padding max-width
                            ">
                            <article>
                                <div class="jumbotron">
    <p>When the consumer has <strong>completed</strong> the entire
<a href="checkin">Checkin</a> and <a href="payment-menu">Payment Menu</a>, you need to implement the
relevant <strong>after-payment operations</strong> in your order system. Which these
operations are and how they are executed is described below.</p>

</div>
      <h2 id="introduction">
        
        
          Introduction <a href="#introduction" class="header-anchor"></a>
        
        
      </h2>

<p>Below is the final part of the sequence diagram illustrating how a capture
operation is performed.</p>

<pre><code class="language-mermaid">sequenceDiagram
    participant Merchant
    participant SwedbankPay as Swedbank Pay

    rect rgba(81,43,43,0.1)
        activate Merchant
        note left of Payer: Capture
        Merchant -&gt;&gt;+ SwedbankPay: rel:create-paymentorder-capture
        deactivate Merchant
        SwedbankPay --&gt;&gt;- Merchant: Capture status
        note right of Merchant: Capture here only if the purchased&lt;br/&gt;goods don't require shipping.&lt;br/&gt;If shipping is required, perform capture&lt;br/&gt;after the goods have shipped.&lt;br&gt;Should only be used for &lt;br&gt;PaymentInstruments that support &lt;br&gt;Authorizations.
        end
</code></pre>
    
      <h2 id="operations">
        
        
          Operations <a href="#operations" class="header-anchor"></a>
        
        
      </h2>

<p>Most payment instruments are two-phase payments –
in which a successful payment order will result in an authorized transaction –
that must be followed up by a capture or cancellation transaction in a later
stage. One-phase payments like Swish are settled directly without the option to
capture or cancel. For a full list of the available operations, see the.</p>

<table class="table table-striped">
  <thead>
    <tr>
      <th style="text-align: left">Operation</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-html highlighter-rouge">create-paymentorder-capture</code></td>
      <td style="text-align: left">The second part of a two-phase transaction where the authorized amount is sent from the payer to the payee. It is possible to do a part-capture on a subset of the authorized amount. Several captures on the same payment are possible, up to the total authorization amount.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-html highlighter-rouge">create-paymentorder-cancel</code></td>
      <td style="text-align: left">Used to cancel authorized and not yet captured transactions. If a cancellation is performed after doing a part-capture, it will only affect the not yet captured authorization amount.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-html highlighter-rouge">create-paymentorder-reversal</code></td>
      <td style="text-align: left">Used to reverse a payment. It is only possible to reverse a payment that has been captured and not yet reversed.</td>
    </tr>
  </tbody>
</table>

<p>To identify the operations that are available we need to do a <code class="language-html highlighter-rouge">GET</code> request
against the URI of <code class="language-html highlighter-rouge">paymentorder.id</code>:</p>

<p class="code-view-header"><strong>Request</strong></p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="code-view"><code><table class="code-view-table"><tbody><tr><td class="code-view-numbers gl"><pre class="lineno">1
2
</pre></td><td class="code-view-code"><pre><span class="nf">GET</span> <span class="nn">/psp/paymentorders/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Bearer &lt;AccessToken&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The (abbreviated) response containing an <code class="language-html highlighter-rouge">updateorder</code>, <code class="language-html highlighter-rouge">capture</code>,
<code class="language-html highlighter-rouge">cancellation</code>, and <code class="language-html highlighter-rouge">reversal</code> operation should look similar to the response
below:</p>

<p class="code-view-header"><strong>Response</strong></p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="code-view"><code><table class="code-view-table"><tbody><tr><td class="code-view-numbers gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="code-view-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="nl">"paymentOrder"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/psp/paymentorders/"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"operations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PATCH"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/psp/paymentorders/"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"rel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"update-paymentorder-updateorder"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"contentType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/psp/paymentorders//captures"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"rel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"create-paymentorder-capture"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"contentType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/psp/paymentorders//cancellations"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"rel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"create-paymentorder-cancel"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"contentType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/psp/paymentorders//reversals"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"rel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"create-paymentorder-reversal"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"contentType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<table class="table table-striped">
  <thead>
    <tr>
      <th style="text-align: left">Field</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-html highlighter-rouge">paymentorder</code></td>
      <td style="text-align: left"><code class="language-html highlighter-rouge">object</code></td>
      <td style="text-align: left">The payment order object.</td>
    </tr>
    <tr>
      <td style="text-align: left">└➔ <code class="language-html highlighter-rouge">id</code></td>
      <td style="text-align: left"><code class="language-html highlighter-rouge">string</code></td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-html highlighter-rouge">operations</code></td>
      <td style="text-align: left"><code class="language-html highlighter-rouge">array</code></td>
      <td style="text-align: left">The array of possible operations to perform, given the state of the payment order.</td>
    </tr>
  </tbody>
</table>

<div class="alert  alert-informative">
    
    
    <i class="material-icons alert-icon">info</i>
    
    

    
    
    <p>Note that all of the
operations <code class="language-html highlighter-rouge">Cancel</code>, <code class="language-html highlighter-rouge">Capture</code> and <code class="language-html highlighter-rouge">Reversal</code> must be implemented.</p>
    
    
</div>

<nav class="iterator d-flex">
    
    <a class="mr-auto btn btn-secondary" role="button" rel="prev" href="capture">
        Back: Capture
    </a>
    

    
</nav>
                            </article>
                        </div>
                    </main>
                </div>
            </div>
        </div>
        <script src="https://design.swedbankpay.com/v/5.0.1/scripts/dg.js"></script>
        <script src="/swedbank-pay-design-guide-jekyll-theme/assets/js/swedbank-pay-design-guide-theme.js"></script>
    </body>

</html>
